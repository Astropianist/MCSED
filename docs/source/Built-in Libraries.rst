.. _section:Libraries:

The Built-In Libraries
======================

.. _subsec:filters:

Filters
-------

``MCSED`` comes with the transmission curves for :math:`\sim 150` broad-
and narrow-band filters, including sets of filters from Hubble Space
Telescopes’s ACS, WFC3, and WFPC2 cameras, Spitzer’s IRAC and MIPS
detectors, Herschel’s PACS and SPIRE instruments, the Swift UVOT, GALEX,
Subaru’s Suprime-Cam and MOIRCS, the CFHT’s MegaCam and WIRCam, NOAO’s
NEWFIRM and Mosaic Cameras, Keck’s LRIS, the VLT’s VIMOS and ISAAC, the
Magellan Telescopes’s Four Star, and the Sloan Digital Sky Survey.
Additional filters can easily be added to ``MCSED``’s library in the
``FILTERS`` subdirectory.

To enable ``MCSED`` to recognize filters, the user creates a two-column
file which contains the filter filename in the first column and a
user-defined filter name in the second column. The name of this file is
then specified, either in ``config.py`` or through the command line.
Many filter transmission curves can be found on `the SVO Filter Profile
Service <http://svo2.cab.inta-csic.es/theory/fps/>`__. Their ascii files
are in exactly the correct format and can simply be renamed as “.res”
files.

.. _subsec:stellar-isochrones:

Stellar Libraries
-----------------

Because ``MCSED`` is modular, it is relatively straightforward to change
its stellar evolution libraries. ``MCSED`` is distributed with a grid of
SSP spectra generated from the Padova isochrones (Bressan et al. 2012)
by the Flexible Stellar Population Synthesis code developed by Conroy
et al. (2009) and Conroy & Gunn (2010). This library, which contains 22
metallicities ranging from :math:`-1.98` to :math:`+0.20` in
:math:`\log Z/Z_{\odot}` and 84 ages ranging from 6 to 10.15 in log yr,
can be found in the directory ``SSP``. ``MCSED`` builds complex stellar
populations (CSPs) from a linear combinations of these SSPs.

If a user wishes to use a different set of SSP spectra, they can simply
add a subroutine within ``ssp.py``, which returns the following arrays
to ``run_mcsed_fit.py``:

.. raw:: latex

   \centering

.. raw:: latex

   \small

.. table:: SSP Arrays

   +-------------+-------------+----------------+---------------+-----------------------+
   | Array       | Dimension   | Length         | Description   | Units                 |
   +=============+=============+================+===============+=======================+
   | ``ages``    | 1           | [Ages]         | SSP ages      | :math:`\log` yr       |
   +-------------+-------------+----------------+---------------+-----------------------+
   | ``wave``    | 1           | [Wavelengths]  | Spectral      | Å                     |
   |             |             |                | Wavelengths   |                       |
   +-------------+-------------+----------------+---------------+-----------------------+
   | ``SSP``     | 3           | [Wavelengths,  | Spectral      | :math:`\mu`\ Jy       |
   |             |             | Ages,          | Fluxes        | :math:`M_{\odot}^{-1}`|
   |             |             | Metallicities] |               | at 10 pc              |
   +-------------+-------------+----------------+---------------+-----------------------+
   | ``met``     | 1           |[Metallicities] | SSP           | Z                     |
   |             |             |                | Metallicities |                       |
   +-------------+-------------+----------------+---------------+-----------------------+
   |``linewave`` | 1           | [Lines]        | Emission      | Å                     |
   |             |             |                | Line          |                       |
   |             |             |                | Wavelengths   |                       |
   +-------------+-------------+----------------+---------------+-----------------------+
   | ``lineSSP`` | 1           | [Lines]        | Emission      | ergs cm\ :math:`^{-2}`|
   |             |             |                | Line Fluxes   | s\ :math:`^{-1}`      |
   |             |             |                |               |  at 10 pc             |
   +-------------+-------------+----------------+---------------+-----------------------+

This subroutine should be called as an alternative to
``ages, masses, wave, SSP, met, linewave, lineSSP = read_ssp(args)`` in
``run_mcsed_fit.py``. The last two arrays in the table contain the
wavelengths and model line strengths for emission-lines that may be used
in the computation of the fit likelihood (see :ref:`subsec:nebular-emission`).

.. _subsec:nebular-emission:

Nebular Libraries
-----------------

Nebular continuum and line emission can be important for star-forming
populations. ``MCSED`` is distributed with data generated by the
CLOUDY photo-ionization code (Ferland 1998, 2013), which have been
organized by Byler et al. (2017) into a grid with 11 metallicities
(:math:`-2.0 \leq \log Z/Z_{\odot} \leq +0.2`), 7 ionization parameters
(:math:`-4 < \log U < -1`), and 9 ages
(:math:`0.5 \leq t({\rm Myr}) < 10`). One important feature of this grid
is its self-consistency with the Padova isochrone-FSPS spectra: the
prescription for nebular line and continuum emission are based on the
same SSP SEDs included in ``MCSED``. The data files from Byler
et al. (2017), which separate continuum and line emission, are stored in
the subdirectory ``nebular``, and are read in within ``ssp.py``.

If the user wishes to employ a different grid of nebular emission, this
grid should be calculated in a self-consistent manner from the stellar
SSPs, and simply added onto the 3-D grid of stellar spectral flux
densities stored in the array ``SSP`` (see :ref:`subsec:stellar-isochrones`). In addition, to speed the analysis, the user should store the wavelengths and model monochromatic
fluxes for all emission lines that may be used in the maximum likelihood
calculation in the arrays ``linewave`` and ``lineSSP`` (see :ref:`subsec:emission-lines`).